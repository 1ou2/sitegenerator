# Nginx Configuration for Multilingual Site
# /etc/nginx/sites-available/1ou2.com

server {
    listen 80;
    listen [::]:80;
    server_name 1ou2.com www.1ou2.com;
    
    # Redirect to HTTPS (if using SSL)
    return 301 https://$server_name$request_uri;
}

server {
    listen 443 ssl http2;
    listen [::]:443 ssl http2;
    server_name 1ou2.com www.1ou2.com;
    
    root /var/www/your_site;
    index index.html;
    
    # SSL configuration (add your certificates)
    # ssl_certificate /path/to/certificate.crt;
    # ssl_certificate_key /path/to/private.key;
    
    # Root redirect to default language
    location = / {
        # Option 1: Always redirect to French
        return 302 /fr/;
        
        # Option 2: Language detection (advanced)
        # You can implement this with nginx map or lua
        # For now, simple redirect to French is recommended
    }
    
    # French language routes
    location /fr/ {
        try_files $uri $uri/ /fr/index.html;
        
        # Add French language header
        add_header Content-Language fr;
    }
    
    # English language routes  
    location /en/ {
        try_files $uri $uri/ /en/index.html;
        
        # Add English language header
        add_header Content-Language en;
    }
    
    # Assets and static files (shared across languages)
    location /assets/ {
        expires 30d;
        add_header Cache-Control "public, immutable";
    }
    
    # Static pages (contact, livres, etc.)
    location ~ \.(html|css|js|png|jpg|jpeg|gif|ico|svg)$ {
        expires 7d;
        add_header Cache-Control "public";
    }
    
    # Security headers
    add_header X-Frame-Options DENY;
    add_header X-Content-Type-Options nosniff;
    add_header X-XSS-Protection "1; mode=block";
}

# Advanced Language Detection (Optional)
# You can implement this for automatic language detection:
#
# map $http_accept_language $lang {
#     default fr;
#     "~*en" en;
#     "~*fr" fr;
# }
#
# Then in the root location:
# location = / {
#     return 302 /$lang/;
# }